&GLOBAL
  PROJECT perovskite_bandgap
  RUN_TYPE ENERGY
  PRINT_LEVEL MEDIUM
&END GLOBAL

&FORCE_EVAL
  METHOD Quickstep
  &DFT
    BASIS_SET_FILE_NAME  BASIS_file 
    POTENTIAL_FILE_NAME  POTENTIALS_file
    BASIS_SET_FILE_NAME  BASIS_ADMM_MOLOPT
    BASIS_SET_FILE_NAME  BASIS_ADMM

    &PRINT                
       &MO_CUBES
       WRITE_CUBE .FALSE. 
       NHOMO 1            
       NLUMO 1            
       &END
    &END
    &QS
     METHOD GPW
     EXTRAPOLATION PS 
     EXTRAPOLATION_ORDER 3
     EPS_DEFAULT 1.0E-10              #E-6
    &END QS
    &POISSON
      PERIODIC XYZ
    &END POISSON
    &SCF
      SCF_GUESS ATOMIC
      EPS_SCF 1.0E-6                  #E-7
      MAX_SCF 30
      !EPS_LUMO 1.00000000E-005
      !CHOLESKY INVERSE
      
      &OT
       PRECONDITIONER FULL_SINGLE_INVERSE        #FULL ALL
       MINIMIZER DIIS              # minimiser cg
       ALGORITHM IRAC             #no algorithm before
       ENERGY_GAP 0.01
      &END
      &OUTER_SCF 
				MAX_SCF 20
				EPS_SCF 1e-06
      &END OUTER_SCF 
      &MIXING
        METHOD BROYDEN_MIXING
        ALPHA 0.2
        BETA 1.5
        NBROYDEN 8
      &END MIXING
    &END SCF
    &MGRID 
			CUTOFF 940
			REL_CUTOFF 80
			NGRIDS 5
			PROGRESSION_FACTOR 3
    &END MGRID
    &XC
      &XC_FUNCTIONAL PBE
       &PBE                  
           SCALE_X 0.750
           SCALE_C 1.0
       &END
       &PBE_HOLE_T_C_LR
           SCALE_X 0.25       ! + 25% of truncated PBE0 functional - that includes exact hfx
           CUTOFF_RADIUS 4.19759400000000000000  ! that has interaction truncated at 3.5 A from the atomic core 
       &END
      &END XC_FUNCTIONAL
      &VDW_POTENTIAL
        POTENTIAL_TYPE pair_potential
        &PAIR_POTENTIAL
          TYPE DFTD3(BJ)
          PARAMETER_FILE_NAME dftd3.dat
          REFERENCE_FUNCTIONAL PBE
        &END PAIR_POTENTIAL
      &END VDW_POTENTIAL
      &HF
        FRACTION 0.25         
        &SCREENING            
          EPS_SCHWARZ 1.0E-7
          !SCREEN_ON_INITIAL_P TRUE  
        &END                        
        &MEMORY
          MAX_MEMORY 7500   
        &END
        &INTERACTION_POTENTIAL      
          POTENTIAL_TYPE TRUNCATED  
          CUTOFF_RADIUS 4.19759400000000000000         
          T_C_G_DATA ./t_c_g.dat    
        &END                        
      &END
    &END XC
    &AUXILIARY_DENSITY_MATRIX_METHOD 
			ADMM_PURIFICATION_METHOD NONE
			METHOD BASIS_PROJECTION
	  &END AUXILIARY_DENSITY_MATRIX_METHOD
  &END DFT

  &SUBSYS
    &CELL
      
      CELL_FILE_FORMAT CIF
      CELL_FILE_NAME Cs1_K1_Sr6_Zr8_O24_1_15.cif 
    &END CELL
    
    &TOPOLOGY
      COORD_FILE_FORMAT xyz
      COORD_FILE_NAME Cs1_K1_Sr6_Zr8_O24_1_15.xyz
    &END TOPOLOGY
    &KIND Mg 
      ELEMENT   Mg
      BASIS_SET DZVP-MOLOPT-SR-GTH-q2 
      POTENTIAL GTH-PBE-q2
      BASIS_SET AUX_FIT cFIT3
    &END KIND
    &KIND Y
      ELEMENT   Y
      BASIS_SET DZVP-MOLOPT-SR-GTH-q11
      POTENTIAL GTH-PBE-q11
      BASIS_SET AUX_FIT cFIT13
    &END KIND
    &KIND Ba 
      ELEMENT   Ba
      BASIS_SET DZVP-MOLOPT-SR-GTH-q10
      POTENTIAL GTH-PBE-q10
      BASIS_SET AUX_FIT cFIT9
    &END KIND
    &KIND Sr 
      ELEMENT   Sr
      BASIS_SET DZVP-MOLOPT-SR-GTH-q10
      POTENTIAL GTH-PBE-q10
      BASIS_SET AUX_FIT cFIT9
    &END KIND
    &KIND Li
      ELEMENT   Li
      BASIS_SET DZVP-MOLOPT-SR-GTH-q3
      POTENTIAL GTH-PBE-q3
      BASIS_SET AUX_FIT cFIT5
    &END KIND
    &KIND Cs 
      ELEMENT   Cs
      BASIS_SET DZVP-MOLOPT-SR-GTH-q9
      POTENTIAL GTH-PBE-q9
      BASIS_SET AUX_FIT cFIT9
    &END KIND
    &KIND Hf
      ELEMENT   Hf
      BASIS_SET DZVP-MOLOPT-SR-GTH-q12
      POTENTIAL GTH-PBE-q12
      BASIS_SET AUX_FIT cFIT13
    &END KIND
    &KIND Sc
      ELEMENT   Sc
      BASIS_SET DZVP-MOLOPT-SR-GTH-q11
      POTENTIAL GTH-PBE-q11
      BASIS_SET AUX_FIT cFIT13
    &END KIND
    &KIND Sb
      ELEMENT   Sb
      BASIS_SET DZVP-MOLOPT-SR-GTH-q5
      POTENTIAL GTH-PBE-q5
      BASIS_SET AUX_FIT cFIT9
    &END KIND
    &KIND Si
      ELEMENT   Sc
      BASIS_SET DZVP-MOLOPT-SR-GTH-q4
      POTENTIAL GTH-PBE-q4
      BASIS_SET AUX_FIT cFIT3
    &END KIND
    &KIND Ta
      ELEMENT   Ta
      BASIS_SET DZVP-MOLOPT-SR-GTH-q13
      POTENTIAL GTH-PBE-q13
      BASIS_SET AUX_FIT cFIT13
    &END KIND
    &KIND Ti
      ELEMENT   Ti
      BASIS_SET DZVP-MOLOPT-SR-GTH-q12
      POTENTIAL GTH-PBE-q12
      BASIS_SET AUX_FIT cFIT13
    &END KIND
    &KIND Zr
      ELEMENT   Zr
      BASIS_SET DZVP-MOLOPT-SR-GTH-q12
      POTENTIAL GTH-PBE-q12
      BASIS_SET AUX_FIT cFIT12
    &END KIND
    &KIND V
      ELEMENT   V
      BASIS_SET DZVP-MOLOPT-SR-GTH-q13
      POTENTIAL GTH-PBE-q13
      BASIS_SET AUX_FIT cFIT13
    &END KIND
    &KIND Al
      ELEMENT   Al
      BASIS_SET DZVP-MOLOPT-SR-GTH-q3
      POTENTIAL GTH-PBE-q3
      BASIS_SET AUX_FIT cFIT9
    &END KIND
    &KIND K
      ELEMENT   K
      BASIS_SET DZVP-MOLOPT-SR-GTH-q9
      POTENTIAL GTH-PBE-q9
      BASIS_SET AUX_FIT cFIT9
    &END KIND
    &KIND Rb
      ELEMENT   Rb
      BASIS_SET DZVP-MOLOPT-SR-GTH-q9
      POTENTIAL GTH-PBE-q9
      BASIS_SET AUX_FIT cFIT9
    &END KIND
    &KIND O
      ELEMENT   O
      BASIS_SET DZVP-MOLOPT-SR-GTH-q6
      POTENTIAL GTH-PBE-q6
      BASIS_SET AUX_FIT FIT9
    &END KIND
    &KIND Na 
      ELEMENT   Na
      BASIS_SET DZVP-MOLOPT-SR-GTH-q9
      POTENTIAL GTH-PBE-q9
      BASIS_SET AUX_FIT cFIT3
    &END KIND
    &KIND Nb
      ELEMENT Nb
      BASIS_SET DZVP-MOLOPT-SR-GTH-q13
      POTENTIAL GTH-PBE-q13
      BASIS_SET AUX_FIT cFIT13
    &END KIND
    &KIND Ca
      BASIS_SET DZVP-MOLOPT-SR-GTH-q10
      POTENTIAL GTH-PBE-q10
      BASIS_SET AUX_FIT cFIT10
    &END KIND
  &END SUBSYS

&END FORCE_EVAL
